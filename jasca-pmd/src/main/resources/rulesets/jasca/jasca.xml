<?xml version="1.0" encoding="UTF-8"?>

<ruleset name="Jasca"
	xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 http://pmd.sourceforge.net/ruleset_2_0_0.xsd">
	
	<description>
	</description>
	
	<!--
	<rule ref="rulesets/java/basic.xml"/>
	<rule ref="rulesets/java/empty.xml"/>
	<rule ref="rulesets/java/design.xml"/>
	<rule ref="rulesets/java/unnecessary.xml"/>
	<rule ref="rulesets/jsp/basic.xml"/>
	-->
	
	<rule name="DynamicClassLoading"
		language="java"
		since="jasca 1.0"
		message="동적으로 로딩한 클래스는 코드 무결성 검사를 수행하십시오"
		class="com.tyn.jasca.pmd.rule.DynamicClassLoadingRule"
		externalInfoUrl="http://cwe.mitre.org/data/definitions/494.html">
		
		<description>
		</description>
		<priority>3</priority>
		<example>
<![CDATA[
URL[] classURLs= new URL[]{
    new URL("file:subdir/")
};
URLClassLoader loader = new URLClassLoader(classURLs);
Class loadedClass = Class.forName("loadMe", true, loader);
]]>
		</example>
	</rule>
	
	<rule name="ReverseDNSResolution"
		language="java"
		since="jasca 1.0"
		message="보안결정에서 DNS lookup을 통한 도메인명을 사용하지 마십시오"
		class="com.tyn.jasca.pmd.rule.ReverseDNSResolutionRule"
		externalInfoUrl="http://cwe.mitre.org/data/definitions/350.html">
		
		<description>
		</description>
		<priority>3</priority>
		<example>
<![CDATA[
String ip = request.getRemoteAddr();
InetAddress addr = InetAddress.getByName(ip);
if (addr.getCanonicalHostName().endsWith("trustme.com")) {
    trusted = true;
}
]]>
		</example>
	</rule>
	
	<rule name="UseDangerousMethod"
		language="java"
		since="jasca 1.0"
		message="보안문제를 유발할 수 있는 메소드를 사용하지 마십시오"
		class="net.sourceforge.pmd.lang.rule.XPathRule"
		externalInfoUrl="http://cwe.mitre.org/data/definitions/676.html">
		
		<description>
		</description>
		<priority>3</priority>
		<properties>
			<property name="xpath">
				<value>
<![CDATA[
//PrimaryExpression
[
 	PrimaryPrefix/Name[ends-with(@Image, 'getSessionContext')]
 	
 	or
 	
	PrimarySuffix[ends-with(@Image, 'getSessionContext')]
]
]]>
				</value>
			</property>
		</properties>
		<example>
<![CDATA[
]]>
		</example>
	</rule>
	
</ruleset>
